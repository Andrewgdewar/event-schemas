{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://console.redhat.com/api/schemas/events/v1/events.json",
  "title": "console.redhat.com CloudEvents Schema",
  "description": "See https://raw.githubusercontent.com/cloudevents/spec/main/cloudevents/formats/cloudevents.json for base CloudEvents schema. NOTE: this schema inlines and further constrains some CloudEvents properties",
  "type": "object",
  "properties": {
    "id": {
      "description": "Identifies the event.",
      "type": "string",
      "pattern": "urn:redhat:console:event:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
      "examples": [
        "urn:redhat:console:event:12b50cf4-2f4a-4c29-ac37-0081fc8c9428"
      ]
    },
    "source": {
      "description": "Describes the console.redhat.com app that generated the event.",
      "type": "string",
      "pattern": "urn:redhat:console:app:.*",
      "examples": [
        "urn:redhat:console:app:advisor"
      ]
    },
    "subject": {
      "description": "Describes the subject of the event. URN in format urn:redhat:console:$instance_type:$id. The urn may be longer to accommodate hierarchies",
      "type": "string",
      "pattern": "urn:redhat:console:.*:.*",
      "examples": [
        "urn:redhat:console:rhel_system:2356aad8-de45-4ba0-80bd-4637763ad115",
        "urn:redhat:console:rhel_system:2356aad8-de45-4ba0-80bd-4637763ad115:mssql_instance:b24c269d-33d6-410e-8808-c71c9635e84f",
        "urn:redhat:console:ansible_cluster:2356aad8-de45-4ba0-80bd-4637763ad115",
        "urn:redhat:console:cve:CVE-2014-0160"
      ]
    },
    "specversion": {
      "description": "Specifies the version of the CloudEvents spec targeted.",
      "type": "string",
      "enum": [
        "1.0"
      ]
    },
    "type": {
      "description": "The type of the event.",
      "type": "string",
      "pattern": "com\\.redhat\\.console\\..*",
      "examples": [
        "com.redhat.console.advisor.new-recommendations",
        "com.redhat.console.subscriptions.vdc-misconfiguration"
      ]
    },
    "dataschema": {
      "description": "Identifies the schema that data adheres to.",
      "type": "string",
      "pattern": "https://console.redhat.com/api/schemas/.*"
    },
    "data": {
      "type": "object",
      "oneOf": [
        {
          "$ref": "../../apps/advisor/v1/advisor-recommendations.json"
        },
        {
          "$ref": "../../core/v1/empty.json"
        },
        {
          "$ref": "../../core/v1/error.json"
        },
        {
          "$ref": "../../core/v1/rhel_system.json"
        }
      ]
    },
    "time": {
      "description": "Timestamp of when the occurrence happened. Must adhere to RFC 3339.",
      "type": "string",
      "$ref": "#/definitions/timedef",
      "examples": [
        "2018-04-05T17:31:00Z"
      ]
    },
    "redhatorgid": {
      "description": "Red Hat Organization ID",
      "$ref": "#/definitions/redhatorgiddef",
      "examples": [
        "123456"
      ]
    },
    "redhatconsolebundle": {
      "description": "Describes the console.redhat.com bundle.",
      "$ref": "#/definitions/redhatconsolebundledef"
    }
  },
  "required": [
    "id",
    "source",
    "subject",
    "specversion",
    "type",
    "dataschema",
    "time",
    "redhatorgid"
  ],
  "definitions": {
    "timedef": {
      "type": "string",
      "format": "date-time",
      "minLength": 1
    },
    "redhatorgiddef": {
      "type": "string",
      "minLength": 1
    },
    "redhatconsolebundledef": {
      "type": "string",
      "minLength": 1
    }
  }
}
